<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Welcome to nxselector’s documentation! &#8212; NXS Component Selector 3.20.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/bootstrap-sphinx.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="#">
          NXS Component Selector</a>
        <span class="navbar-text navbar-version pull-left"><b>3.20</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Welcome to nxselector’s documentation!</a><ul>
<li><a class="reference internal" href="#installation">Installation</a><ul>
<li><a class="reference internal" href="#from-sources">From sources</a></li>
<li><a class="reference internal" href="#debian-packages">Debian packages</a></li>
<li><a class="reference internal" href="#from-pip">From pip</a></li>
</ul>
</li>
<li><a class="reference internal" href="#setting-environment">Setting environment</a><ul>
<li><a class="reference internal" href="#setting-saradna">Setting Saradna</a></li>
<li><a class="reference internal" href="#setting-nexus-servers">Setting NeXus Servers</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#general-overview">General overview</a><ul>
<li><a class="reference internal" href="#device-selection">Device Selection</a></li>
<li><a class="reference internal" href="#icons">Icons</a></li>
</ul>
</li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <section id="welcome-to-nxselector-s-documentation">
<h1>Welcome to nxselector’s documentation!<a class="headerlink" href="#welcome-to-nxselector-s-documentation" title="Permalink to this heading">¶</a></h1>
<p><a class="reference external" href="https://github.com/nexdatas/nxselector/actions"><img alt="" src="https://github.com/nexdatas/nxselector/actions/workflows/tests.yml/badge.svg" /></a>
<a class="reference external" href="https://nexdatas.github.io/nxselector/index.html"><img alt="" src="https://img.shields.io/badge/Documentation-webpages-ADD8E6.svg" /></a>
<a class="reference external" href="https://pypi.python.org/pypi/nxselector"><img alt="" src="https://img.shields.io/pypi/v/nxselector.svg" /></a>
<a class="reference external" href="https://pypi.python.org/pypi/nxselector/"><img alt="" src="https://img.shields.io/pypi/pyversions/nxselector.svg" /></a></p>
<p>Authors: Jan Kotanski</p>
<p>NeXus Component Selector
is a GUI configuration tool dedicated to select components
as well as datasources which constitute the XML configuration strings of
Nexus Data Writer via Sardana NeXus Recorder.</p>
<div class="line-block">
<div class="line">Source code: <a class="reference external" href="https://github.com/nexdatas/nxselector">https://github.com/nexdatas/nxselector</a></div>
<div class="line">Web page:  <a class="reference external" href="https://nexdatas.github.io/nxselector">https://nexdatas.github.io/nxselector</a></div>
<div class="line">NexDaTaS Web page: <a class="reference external" href="https://nexdatas.github.io">https://nexdatas.github.io</a></div>
</div>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this heading">¶</a></h2>
<p>Install the dependencies:</p>
<div class="line-block">
<div class="line">Sardana, tango, sphinx, Taurus, NXSRecSelector</div>
</div>
<section id="from-sources">
<h3>From sources<a class="headerlink" href="#from-sources" title="Permalink to this heading">¶</a></h3>
<p>Download the latest version of NeXuS Configuration Server from</p>
<div class="line-block">
<div class="line"><a class="reference external" href="https://github.com/nexdatas/nxselector">https://github.com/nexdatas/nxselector</a></div>
</div>
<p>Extract the sources and run</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python<span class="w"> </span>setup.py<span class="w"> </span>install
</pre></div>
</div>
</section>
<section id="debian-packages">
<h3>Debian packages<a class="headerlink" href="#debian-packages" title="Permalink to this heading">¶</a></h3>
<p>Debian <cite>bookworm</cite>, <cite>bullseye</cite>, <cite>buster</cite> or Ubuntu  <cite>lunar</cite>, <cite>jammy</cite>, <cite>focal</cite> packages can be found in the HDRI repository.</p>
<p>To install the debian packages, add the PGP repository key</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>sudo<span class="w"> </span>su
<span class="gp">$ </span>wget<span class="w"> </span>-q<span class="w"> </span>-O<span class="w"> </span>-<span class="w"> </span>http://repos.pni-hdri.de/debian_repo.pub.gpg<span class="w"> </span><span class="p">|</span><span class="w"> </span>apt-key<span class="w"> </span>add<span class="w"> </span>-
</pre></div>
</div>
<p>and then download the corresponding source list, e.g.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>/etc/apt/sources.list.d
<span class="gp">$ </span>wget<span class="w"> </span>http://repos.pni-hdri.de/bookworm-pni-hdri.list
</pre></div>
</div>
<p>Finally,</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>apt-get<span class="w"> </span>update
<span class="gp">$ </span>apt-get<span class="w"> </span>install<span class="w"> </span>python3-nxsrecselector<span class="w"> </span>nxselector<span class="w"> </span>nxsrecselector
</pre></div>
</div>
<p>To instal other NexDaTaS packages</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>apt-get<span class="w"> </span>install<span class="w"> </span>python3-nxswriter<span class="w"> </span>nxsconfigtool<span class="w"> </span>nxstools<span class="w"> </span>python3-nxsconfigserver<span class="w"> </span>nxsconfigserver-db
</pre></div>
</div>
<p>and</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>apt-get<span class="w"> </span>install<span class="w"> </span>python3-sardana-nxsrecorder<span class="w"> </span>nxstaurusgui
</pre></div>
</div>
<p>for NeXus recorder and MacroGUI packages.</p>
</section>
<section id="from-pip">
<h3>From pip<a class="headerlink" href="#from-pip" title="Permalink to this heading">¶</a></h3>
<p>To install it from pip you need also to install pyqt5, e.g.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python3<span class="w"> </span>-m<span class="w"> </span>venv<span class="w"> </span>myvenv
<span class="gp">$ </span>.<span class="w"> </span>myvenv/bin/activate

<span class="gp">$ </span>pip<span class="w"> </span>install<span class="w"> </span>pyqt5

<span class="gp">$ </span>pip<span class="w"> </span>install<span class="w"> </span>nxselector
</pre></div>
</div>
<p>Moreover it is also good to install</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>pip<span class="w"> </span>install<span class="w"> </span>pytango
<span class="gp">$ </span>pip<span class="w"> </span>install<span class="w"> </span>sardana
<span class="gp">$ </span>pip<span class="w"> </span>install<span class="w"> </span>nxswriter
<span class="gp">$ </span>pip<span class="w"> </span>install<span class="w"> </span>nxsrecselector
<span class="gp">$ </span>pip<span class="w"> </span>install<span class="w"> </span>nxsconfigserver
<span class="gp">$ </span>pip<span class="w"> </span>install<span class="w"> </span>nxstools
<span class="gp">$ </span>pip<span class="w"> </span>install<span class="w"> </span>pymysqldb
</pre></div>
</div>
</section>
</section>
<section id="setting-environment">
<h2>Setting environment<a class="headerlink" href="#setting-environment" title="Permalink to this heading">¶</a></h2>
<section id="setting-saradna">
<h3>Setting Saradna<a class="headerlink" href="#setting-saradna" title="Permalink to this heading">¶</a></h3>
<p>If sardana is not yet set up run</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>Pool
</pre></div>
</div>
<ul class="simple">
<li><p>enter a new instance name</p></li>
<li><p>create the new instance</p></li>
</ul>
<p>Then wait a while until Pool is started and in a new terminal run</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>MacroServer
</pre></div>
</div>
<ul class="simple">
<li><p>enter a new instance name</p></li>
<li><p>create the new instance</p></li>
<li><p>connect pool</p></li>
</ul>
<p>Next, run Astor and change start-up levels: for Pool to 2,
for MacroServer to 3 and restart servers.</p>
<p>Alternatively, terminate Pool and MacroServer in the terminals and run</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>nxsetup<span class="w"> </span>start<span class="w"> </span>Pool<span class="w"> </span>-l2
</pre></div>
</div>
<p>wait until Pool is started and run</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>nxsetup<span class="w"> </span>start<span class="w"> </span>MacroServer<span class="w"> </span>-l3
</pre></div>
</div>
<p>Additionally, one can create dummy devices by running <cite>sar_demo</cite> in</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>spock
</pre></div>
</div>
</section>
<section id="setting-nexus-servers">
<h3>Setting NeXus Servers<a class="headerlink" href="#setting-nexus-servers" title="Permalink to this heading">¶</a></h3>
<p>To set up  NeXus Servers run</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>nxsetup<span class="w"> </span><span class="nb">set</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>nxsetup<span class="w"> </span><span class="nb">set</span><span class="w"> </span>NXSDataWriter
<span class="gp">$ </span>nxsetup<span class="w"> </span><span class="nb">set</span><span class="w"> </span>NXSConfigServer
<span class="gp">$ </span>nxsetup<span class="w"> </span><span class="nb">set</span><span class="w"> </span>NXSRecSelector
</pre></div>
</div>
<p>for specific servers.</p>
<p>If the <cite>RecoderPath</cite> property of MacroServer is not set one can do it by</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>nxsetup<span class="w"> </span>add-recoder-path<span class="w"> </span>/usr/lib/python2.7/dist-packages/sardananxsrecorder
</pre></div>
</div>
<p>where the path should point the <cite>sardananxsrecorder</cite> package.</p>
</section>
</section>
</section>
<section id="general-overview">
<h1>General overview<a class="headerlink" href="#general-overview" title="Permalink to this heading">¶</a></h1>
<section id="device-selection">
<h2>Device Selection<a class="headerlink" href="#device-selection" title="Permalink to this heading">¶</a></h2>
<p>Every measurement requires devices to be selected. The Component Selector (CS) is a graphical user interface serving this purpose. It is launched from a Linux terminal by</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>nxselector
</pre></div>
</div>
<p>or from Spock by</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">p09/door/haspp09.01 [1]: nxselector</span>
</pre></div>
</div>
<figure class="align-default" id="id1">
<span id="figure-1-1"></span><img alt="https://github.com/nexdatas/nxselector/blob/develop/doc/png/detectors_23.png?raw=true" src="https://github.com/nexdatas/nxselector/blob/develop/doc/png/detectors_23.png?raw=true" />
<figcaption>
<p><span class="caption-text">Figure 1.1: Component Selector: Detectors</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>Configuration of the each hardware device for the NeXus files is described inside a configution string, i.e. a configuration component. The employed configuration concept is inspired by the following hardware/configuration correspondences:
.. For more details about NeXus configuration components and their data sources see Section 10.7</p>
<div class="line-block">
<div class="line"><em>measurement</em> &lt;=&gt; <em>file</em></div>
<div class="line"><em>experimental setup</em> &lt;=&gt; <em>NeXus configuration</em></div>
<div class="line"><em>hardware device</em> &lt;=&gt; <em>component</em></div>
<div class="line"><em>device attribute</em>, e.g. counter reading, motor position &lt;=&gt; <em>data source</em></div>
<div class="line"><br /></div>
</div>
<p>The <cite>Figure 1.1</cite> displays the Detectors tab of the Component Selector including the available device components. Composite components are the one with multiple data sources. Simple components are distributed in the frames labelled Counters, ADC, MCA, etc. Components are selected by activating the <em>Sel.</em> checkbox. If the <em>Dis.</em> checkbox is enabled, the output of the device is displayed during the scan for monitoring purposes.</p>
<p>Simple components may be part of composite components. As a consequence, selecting a composite component may implicitly select one or more simple components. This dependency has to be visible for the users. Therefore, simple components being implicitly selected are deactivated and their font colour changes to grey. The user may also move the mouse over a composite component to inspect the contents.</p>
<p>Ideally all devices are contained in components ensuring that they have sensible NeXus paths and meaningful metadata associated with them. In practice this is not always possible. Consider a counter module with 32 channels. Some of them are permanently connected to specific detectors. It is an easy task to create components for these inputs. However, during the course of a beamtime, it may happen that a researcher needs to record some other signal. Depending on the circumstances it may be impossible to create a new component immediately. Still the new signal has to be recorded. In order to handle this situation, dynamical components have been introduced. They are automatically created whenever a selected device is not covered by a component.</p>
<p>In the upper part of the Selector window the user sets Scan File, Scan Directory and if consecutive scans are appended to one file or stored separately. To use NeXus Sardana Recorder the file extension has to be set to <em>.nxs</em> , <em>.nx</em> , <em>.h5</em>, <em>.ndf</em>. <strong>Before the scan all the changes has to be confirmed by the Apply button</strong>. Its action updates settings of the active Sardana measurement group and configuration of the Component Selector.</p>
<p>The Others button of Detectors allows for the user to add simple devices into the measurement group. Its attribute values will be stored for each the scan point.</p>
<p>After devices have been selected and applied the state of all tabs is stored into a profile in the NeXuS Configuration Server. The <strong>profile</strong> contains setting informations, i.e. selected components, user data and file settings, required to prepare configuration for the NeXus writer. The profile extends its measurement group so they share the same name. It is possible to create several profiles. A required profile can be loaded to restore a particular device selection. It is done automatically by changing <em>MntGrp</em> in the Selector.</p>
<p>Moreover, by pressing the <em>Save</em> or <em>Load</em> buttons, the user can save to a file or load the current scan profile. This way, the researcher can easily switch from one data acquisition setup to another.</p>
<figure class="align-default" id="id2">
<span id="figure-1-2"></span><img alt="https://github.com/nexdatas/nxselector/blob/develop/doc/png/descriptions_23.png?raw=true" src="https://github.com/nexdatas/nxselector/blob/develop/doc/png/descriptions_23.png?raw=true" />
<figcaption>
<p><span class="caption-text">Figure 1.2: Component Selector: Descriptions</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>The Descriptions tab, <cite>Figure 1.2</cite>, displays components containing metadata which are stored only before or after the scan. They are divided into two groups: the <em>Mandatory</em> beamline-specific components and the <em>Optional</em> discipline-specific components. The <em>Mandatory</em> beamline group describes the source device and the facility. The <em>Optional</em> discipline group contains information about the spatial arrangement of the experimental setup, mainly motor positions. The user can select or deselect the optional components from the current profile.</p>
<p>Moreover, the <em>Reset Desc.</em> button of Descriptions sets a group of descriptive components to the default one, i.e. defined in the DefaultAutomaticComponents property of the current NXSRecSelector server.</p>
<p>The <em>Others</em> button of Descriptions allows for the user to add simple devices into the profile descriptions, i.e. <em>Other Optional</em>. Its attribute values will be stored before the scan point.</p>
<p>During appling the selected profile informations from Descriptive components are also stored in the <em>PreScanSnapshot</em> door environment variable.
This helps to store the metadata informations by other Sardana recorders.</p>
<figure class="align-default" id="id3">
<span id="figure-1-3"></span><img alt="https://github.com/nexdatas/nxselector/blob/develop/doc/png/udata_23.png?raw=true" src="https://github.com/nexdatas/nxselector/blob/develop/doc/png/udata_23.png?raw=true" />
<figcaption>
<p><span class="caption-text">Figure 1.3: Component Selector: NeXus User Data</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>In order to describe the experiment completely some of the client data have to be provided by the user. The <cite>Figure 1.3</cite> shows the CS tab allowing the researcher to supply this information. Typical examples for user-supplied metadata are title, sample name and user comment.</p>
<p>The layout of the Component Selector can be easily adapted into different beamline specification in the Configuration tab.</p>
</section>
<section id="icons">
<h2>Icons<a class="headerlink" href="#icons" title="Permalink to this heading">¶</a></h2>
<p>Icons fetched from <a class="reference external" href="http://findicons.com/pack/990/vistaico_toolbar">http://findicons.com/pack/990/vistaico_toolbar</a>.</p>
</section>
</section>
<section id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this heading">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2012-2017 DESY, Jan Kotanski &lt;jkotan@mail.desy.de&gt;

GNU GENERAL PUBLIC LICENSE, version 3.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.<br/>
    </p>
  </div>
</footer>
  </body>
</html>