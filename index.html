<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Welcome to nxselector’s documentation! &mdash; NXSConfigServer 3.2.1 documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '3.2.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="NXSConfigServer 3.2.1 documentation" href="#" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="#">NXSConfigServer 3.2.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Welcome to nxselector&#8217;s documentation!</a><ul>
<li><a class="reference internal" href="#installation">Installation</a><ul>
<li><a class="reference internal" href="#from-sources">From sources</a></li>
<li><a class="reference internal" href="#debian-packages">Debian packages</a></li>
</ul>
</li>
<li><a class="reference internal" href="#setting-environment">Setting environment</a><ul>
<li><a class="reference internal" href="#setting-saradna">Setting Saradna</a></li>
<li><a class="reference internal" href="#setting-nexus-servers">Setting NeXus Servers</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#general-overview">General overview</a><ul>
<li><a class="reference internal" href="#device-selection">Device Selection</a></li>
<li><a class="reference internal" href="#icons">Icons</a></li>
</ul>
</li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/index.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="welcome-to-nxselector-s-documentation">
<h1>Welcome to nxselector&#8217;s documentation!<a class="headerlink" href="#welcome-to-nxselector-s-documentation" title="Permalink to this headline">¶</a></h1>
<p>Authors: Jan Kotanski</p>
<p>NeXus Component Selector
is a GUI configuration tool dedicated to select components
as well as datasources which constitute the XML configuration strings of
Nexus Data Writer via Sardana NeXus Recorder.</p>
<div class="line-block">
<div class="line">Source code: <a class="reference external" href="https://github.com/nexdatas/selector">https://github.com/nexdatas/selector</a></div>
<div class="line">Web page:  <a class="reference external" href="https://nexdatas.github.io/selector">https://nexdatas.github.io/selector</a></div>
</div>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>Install the dependencies:</p>
<blockquote>
<div>Sardana, PyTango, sphinx, Taurus, NXSRecSelector</div></blockquote>
<div class="section" id="from-sources">
<h3>From sources<a class="headerlink" href="#from-sources" title="Permalink to this headline">¶</a></h3>
<p>Download the latest version of NeXuS Configuration Server from</p>
<blockquote>
<div><a class="reference external" href="https://github.com/nexdatas/selector">https://github.com/nexdatas/selector</a></div></blockquote>
<p>Extract the sources and run</p>
<div class="code bash highlight-python"><div class="highlight"><pre>$ python setup.py install
</pre></div>
</div>
</div>
<div class="section" id="debian-packages">
<h3>Debian packages<a class="headerlink" href="#debian-packages" title="Permalink to this headline">¶</a></h3>
<p>Debian Jessie (and Wheezy) packages can be found in the HDRI repository.</p>
<p>To install the debian packages, add the PGP repository key</p>
<div class="code bash highlight-python"><div class="highlight"><pre>$ sudo su
$ wget -q -O - http://repos.pni-hdri.de/debian_repo.pub.gpg | apt-key add -
</pre></div>
</div>
<p>and then download the corresponding source list</p>
<div class="code bash highlight-python"><div class="highlight"><pre>$ cd /etc/apt/sources.list.d
$ wget http://repos.pni-hdri.de/jessie-pni-hdri.list
</pre></div>
</div>
<p>Finally,</p>
<div class="code bash highlight-python"><div class="highlight"><pre>$ apt-get update
$ apt-get install python-nxsrecselector nxselector
</pre></div>
</div>
<p>To instal other NexDaTaS packages</p>
<div class="code bash highlight-python"><div class="highlight"><pre>$ apt-get install python-nxswriter nxsconfigtool nxstools python-nxsconfigserver nxsconfigserver-db
</pre></div>
</div>
<p>and</p>
<div class="code bash highlight-python"><div class="highlight"><pre>$ apt-get install python-sardana-nxsrecorder nxstaurusgui
</pre></div>
</div>
<p>for NeXus recorder and MacroGUI packages.</p>
</div>
</div>
<div class="section" id="setting-environment">
<h2>Setting environment<a class="headerlink" href="#setting-environment" title="Permalink to this headline">¶</a></h2>
<div class="section" id="setting-saradna">
<h3>Setting Saradna<a class="headerlink" href="#setting-saradna" title="Permalink to this headline">¶</a></h3>
<p>If sardana is not yet set up run</p>
<div class="code bash highlight-python"><div class="highlight"><pre>$ Pool
</pre></div>
</div>
<ul class="simple">
<li>enter a new instance name</li>
<li>create the new instance</li>
</ul>
<p>Then wait a while until Pool is started and in a new terminal run</p>
<div class="code bash highlight-python"><div class="highlight"><pre>$ MacroServer
</pre></div>
</div>
<ul class="simple">
<li>enter a new instance name</li>
<li>create the new instance</li>
<li>connect pool</li>
</ul>
<p>Next, run Astor and change start-up levels: for Pool to 2,
for MacroServer to 3 and restart servers.</p>
<p>Alternatively, terminate Pool and MacroServer in the terminals and run</p>
<div class="code bash highlight-python"><div class="highlight"><pre>$ nxsetup -s Pool -l2
</pre></div>
</div>
<p>wait until Pool is started and run</p>
<div class="code bash highlight-python"><div class="highlight"><pre>$ nxsetup -s MacroServer -l3
</pre></div>
</div>
<p>Additionally, one can create dummy devices by running <cite>sar_demo</cite> in</p>
<div class="code bash highlight-python"><div class="highlight"><pre>$ spock
</pre></div>
</div>
</div>
<div class="section" id="setting-nexus-servers">
<h3>Setting NeXus Servers<a class="headerlink" href="#setting-nexus-servers" title="Permalink to this headline">¶</a></h3>
<p>To set up  NeXus Servers run</p>
<div class="code bash highlight-python"><div class="highlight"><pre>$ nxsetup -x
</pre></div>
</div>
<p>or</p>
<div class="code bash highlight-python"><div class="highlight"><pre>$ nxsetup -x NXSDataWriter
$ nxsetup -x NXSConfigServer
$ nxsetup -x NXSRecSelector
</pre></div>
</div>
<p>for specific servers.</p>
<p>If the <cite>RecoderPath</cite> property of MacroServer is not set one can do it by</p>
<div class="code bash highlight-python"><div class="highlight"><pre>$ nxsetup -a /usr/lib/python2.7/dist-packages/sardananxsrecorder
</pre></div>
</div>
<p>where the path should point the <cite>sardananxsrecorder</cite> package.</p>
</div>
</div>
</div>
<div class="section" id="general-overview">
<h1>General overview<a class="headerlink" href="#general-overview" title="Permalink to this headline">¶</a></h1>
<div class="section" id="device-selection">
<h2>Device Selection<a class="headerlink" href="#device-selection" title="Permalink to this headline">¶</a></h2>
<p>Every measurement requires devices to be selected. The Component Selector (CS) is a graphical user interface serving this purpose. It is launched from a Linux terminal by</p>
<div class="code bash highlight-python"><div class="highlight"><pre><span class="n">haspp09</span><span class="o">%</span> <span class="n">nxselector</span>
</pre></div>
</div>
<p>or from Spock by</p>
<div class="code bash highlight-python"><div class="highlight"><pre>p09/door/haspp09.01 [1]: nxselector
</pre></div>
</div>
<div class="figure" id="figure-1-1">
<img alt="Component Selector: Detectors" src="_images/detectors_23.png" />
<p class="caption">Figure 1.1: Component Selector: Detectors</p>
</div>
<p>Configuration of the each hardware device for the NeXus files is described inside a configution string, i.e. a configuration component. The employed configuration concept is inspired by the following hardware/configuration correspondences:
.. For more details about NeXus configuration components and their data sources see Section 10.7</p>
<div class="line-block">
<div class="line"><em>measurement</em> &lt;=&gt; <em>file</em></div>
<div class="line"><em>experimental setup</em> &lt;=&gt; <em>NeXus configuration</em></div>
<div class="line"><em>hardware device</em> &lt;=&gt; <em>component</em></div>
<div class="line"><em>device attribute</em>, e.g. counter reading, motor position &lt;=&gt; <em>data source</em></div>
<div class="line"><br /></div>
</div>
<p>The <a class="reference internal" href="#figure-1-1"><em>Figure 1.1: Component Selector: Detectors</em></a> displays the Detectors tab of the Component Selector including the available device components. Composite components are the one with multiple data sources. Simple components are distributed in the frames labelled Counters, ADC, MCA, etc. Components are selected by activating the <em>Sel.</em> checkbox. If the <em>Dis.</em> checkbox is enabled, the output of the device is displayed during the scan for monitoring purposes.</p>
<p>Simple components may be part of composite components. As a consequence, selecting a composite component may implicitly select one or more simple components. This dependency has to be visible for the users. Therefore, simple components being implicitly selected are deactivated and their font colour changes to grey. The user may also move the mouse over a composite component to inspect the contents.</p>
<p>Ideally all devices are contained in components ensuring that they have sensible NeXus paths and meaningful metadata associated with them. In practice this is not always possible. Consider a counter module with 32 channels. Some of them are permanently connected to specific detectors. It is an easy task to create components for these inputs. However, during the course of a beamtime, it may happen that a researcher needs to record some other signal. Depending on the circumstances it may be impossible to create a new component immediately. Still the new signal has to be recorded. In order to handle this situation, dynamical components have been introduced. They are automatically created whenever a selected device is not covered by a component.</p>
<p>In the upper part of the Selector window the user sets Scan File, Scan Directory and if consecutive scans are appended to one file or stored separately. To use NeXus Sardana Recorder the file extension has to be set to <em>.nxs</em> , <em>.nx</em> , <em>.h5</em>, <em>.ndf</em>. <strong>Before the scan all the changes has to be confirmed by the Apply button</strong>. Its action updates settings of the active Sardana measurement group and configuration of the Component Selector.</p>
<p>The Others button of Detectors allows for the user to add simple devices into the measurement group. Its attribute values will be stored for each the scan point.</p>
<p>After devices have been selected and applied the state of all tabs is stored into a profile in the NeXuS Configuration Server. The <strong>profile</strong> contains setting informations, i.e. selected components, user data and file settings, required to prepare configuration for the NeXus writer. The profile extends its measurement group so they share the same name. It is possible to create several profiles. A required profile can be loaded to restore a particular device selection. It is done automatically by changing <em>MntGrp</em> in the Selector.</p>
<p>Moreover, by pressing the <em>Save</em> or <em>Load</em> buttons, the user can save to a file or load the current scan profile. This way, the researcher can easily switch from one data acquisition setup to another.</p>
<div class="figure" id="figure-1-2">
<img alt="Component Selector: Descriptions" src="_images/descriptions_23.png" />
<p class="caption">Figure 1.2: Component Selector: Descriptions</p>
</div>
<p>The Descriptions tab, <a class="reference internal" href="#figure-1-2"><em>Figure 1.2: Component Selector: Descriptions</em></a>, displays components containing metadata which are stored only before or after the scan. They are divided into two groups: the <em>Mandatory</em> beamline-specific components and the <em>Optional</em> discipline-specific components. The <em>Mandatory</em> beamline group describes the source device and the facility. The <em>Optional</em> discipline group contains information about the spatial arrangement of the experimental setup, mainly motor positions. The user can select or deselect the optional components from the current profile.</p>
<p>Moreover, the <em>Reset Desc.</em> button of Descriptions sets a group of descriptive components to the default one, i.e. defined in the DefaultAutomaticComponents property of the current NXSRecSelector server.</p>
<p>The <em>Others</em> button of Descriptions allows for the user to add simple devices into the profile descriptions, i.e. <em>Other Optional</em>. Its attribute values will be stored before the scan point.</p>
<p>During appling the selected profile informations from Descriptive components are also stored in the <em>PreScanSnapshot</em> door environment variable.
This helps to store the metadata informations by other Sardana recorders.</p>
<div class="figure" id="figure-1-3">
<img alt="Component Selector: NeXus User Data" src="_images/udata_23.png" />
<p class="caption">Figure 1.3: Component Selector: NeXus User Data</p>
</div>
<p>In order to describe the experiment completely some of the client data have to be provided by the user. The <a class="reference internal" href="#figure-1-3"><em>Figure 1.3: Component Selector: NeXus User Data</em></a> shows the CS tab allowing the researcher to supply this information. Typical examples for user-supplied metadata are title, sample name and user comment.</p>
<p>The layout of the Component Selector can be easily adapted into different beamline specification in the Configuration tab.</p>
</div>
<div class="section" id="icons">
<h2>Icons<a class="headerlink" href="#icons" title="Permalink to this headline">¶</a></h2>
<p>Icons fetched from <a class="reference external" href="http://findicons.com/pack/990/vistaico_toolbar">http://findicons.com/pack/990/vistaico_toolbar</a>.</p>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><em>Index</em></a></li>
<li><a class="reference internal" href="py-modindex.html"><em>Module Index</em></a></li>
<li><a class="reference internal" href="search.html"><em>Search Page</em></a></li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li><a href="#">NXSConfigServer 3.2.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012-2016 DESY, Jan Kotanski &lt;jkotan@mail.desy.de&gt;

GNU GENERAL PUBLIC LICENSE, version 3.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>